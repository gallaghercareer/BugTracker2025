# Release pipeline for Swap to Production only
trigger:
  - none

pool:
  name: 'Default'

variables:
  projectFile: 'projectFile'

resources:
  pipelines:
  - pipeline: 'buildPipeline'
    source: BugTracker2025-BuildPipeline
    branch: main
    trigger: true

stages:
# Swap Devtest slot into Production
- stage: SwapToProduction
  displayName: Swap Devtest Slot into Production
  dependsOn: []
  condition: succeeded()
  jobs:
  - deployment: SwapSlot
    displayName: Swap Devtest into Production
    environment: 'BugTracker WebApp Service'
    strategy:
      runOnce:
        deploy:
          steps:
          - task: AzureAppServiceManage@0
            displayName: Swap Devtest into Production
            inputs:
              azureSubscription: 'azuredevops-to-azureresource-service-connection'
              WebAppName: 'bugtrackerapi20250516235431'
              ResourceGroupName: 'FinalProReRe20250306152958ResourceGroup'
              SourceSlot: devtest
              SwapWithProduction: true
